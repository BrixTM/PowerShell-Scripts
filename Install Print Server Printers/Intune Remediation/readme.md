This was initially done as a remediation task where we needed to install printers that had been migrated to a print server on devices at specific sites, as such there is a requirement to specify the subnet for the devices. This was also written before the function was created, I would recommend using the function instead of this Remediate script in most cases. As for the detection it should be re-written to have a toggle for the subnet and converted to a function. 